(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3447e4a8"],{"13d5":function(e,t,a){"use strict";var r=a("23e7"),n=a("d58f").left,i=a("a640"),o=a("ae40"),s=a("2d00"),c=a("605d"),d=i("reduce"),u=o("reduce",{1:0}),l=!c&&s>79&&s<83;r({target:"Array",proto:!0,forced:!d||!u||l},{reduce:function(e){return n(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"2d02":function(e,t,a){},"2e64":function(e,t,a){"use strict";a("984f")},"3dae":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("div",{staticClass:"search"},[a("a-form",{attrs:{layout:"inline",form:e.form},on:{submit:e.submitHandler}},[a("a-form-item",{attrs:{label:"服务器地址"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["IP",{rules:[{required:!1,message:"Please input your note!"}]}],expression:"['IP', { rules: [{ required: false, message: 'Please input your note!' }] }]"}],attrs:{placeholder:"请输入服务器IP"}})],1),a("a-form-item",{attrs:{label:"时间"}},[a("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["timePicker",{rules:[{type:"array",required:!1}]}],expression:"['timePicker', {rules: [{ type: 'array', required: false }]}]"}]})],1),a("a-form-item",[a("a-button",{attrs:{type:"primary","html-type":"submit"}},[e._v(" 查询 ")])],1),a("a-form-item",[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return t.preventDefault(),e.createDialog(t)}}},[e._v(" 新建 ")])],1)],1)],1),a("div",[a("bf-table",{attrs:{columns:e.columns,dataSource:e.dataSource,rowKey:"name",pagination:{current:e.params.currentPage,pageSize:e.params.pageSize,total:e.total,showSizeChanger:!0,showLessItems:!0,showQuickJumper:!0,showTotal:function(e,t){return"第 "+t[0]+"-"+t[1]+" 条，总计 "+e+" 条"}}},on:{clear:e.onClear,change:e.onChange},scopedSlots:e._u([{key:"env_name",fn:function(t){var r=t.text;t.record;return[a("a-tag",{attrs:{color:"blue"}},[e._v(e._s(r))])]}},{key:"action",fn:function(t){t.text;var r=t.record;return a("div",{},[a("a-button-group",[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return t.preventDefault(),e.onShowEdit(r)}}},[e._v(" 编辑 ")]),a("a-popconfirm",{attrs:{title:"确定执行删除操作么？","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.onDelete(r)}}},[a("a-button",{attrs:{type:"danger"}},[e._v(" 删除 ")])],1)],1)],1)}}])})],1),a("a-modal",{attrs:{visible:e.visible,title:e.isEdit?"编辑服务器":"新增服务器",okText:e.isEdit?"更新":"新建"},on:{cancel:e.onReset,ok:function(t){e.isEdit?e.onUpdateServer():e.onCreateServer()}}},[a("a-form",{attrs:{layout:"vertical",form:e.formDialog}},[a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"id"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id"],expression:"['id']"}],attrs:{placeholder:"自动生成"}})],1),a("a-form-item",{attrs:{label:"服务器IP"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ip",{rules:[{required:!0,message:"请输入服务器IP"}]}],expression:"[\n            'ip',\n            {\n              rules: [{ required: true, message: '请输入服务器IP' }],\n            }\n          ]"}],attrs:{disabled:!!e.isEdit}})],1),a("a-form-item",{attrs:{label:"服务器端口"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["port",{rules:[{required:!0,message:"请输入服务器端口"}]}],expression:"[\n            'port',\n            {\n              rules: [{ required: true, message: '请输入服务器端口' }],\n            }\n          ]"}],attrs:{disabled:!!e.isEdit}})],1),a("a-form-item",{attrs:{label:"组件选择"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["appId",{rules:[{required:!0,message:"请选择所属的组件!"}]}],expression:"['appId', { rules: [{ required: true, message: '请选择所属的组件!' }] }]"}],staticStyle:{"min-width":"200px",width:"100%"},attrs:{"show-search":"",placeholder:"请选择组件","option-filter-prop":"children","filter-option":e.filterOption}},e._l(e.options,(function(t){return a("a-select-option",{key:t.value},[e._v(" "+e._s(t.label)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"环境选择"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["envId",{rules:[{required:!0,message:"请选择所属的环境!"}]}],expression:"['envId', { rules: [{ required: true, message: '请选择所属的环境!' }] }]"}],staticStyle:{"min-width":"200px",width:"100%"},attrs:{"show-search":"",placeholder:"请选择组件","option-filter-prop":"children","filter-option":e.filterOption}},e._l(e.envOptions,(function(t){return a("a-select-option",{key:t.value},[e._v(" "+e._s(t.label)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"操作系统"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["system",{rules:[{required:!0,message:"请选择操作系统"}]}],expression:"[ 'system', { rules: [{ required: true, message: '请选择操作系统' }] }]"}]},[a("a-select-option",{attrs:{value:"WINDOWS"}},[e._v(" WINDOWS ")]),a("a-select-option",{attrs:{value:"LINUX"}},[e._v(" LINUX ")])],1)],1),a("a-form-item",{attrs:{label:"描述"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["description"],expression:"['description']"}],attrs:{type:"textarea"}})],1)],1)],1)],1)},n=[],i=(a("a4d3"),a("e01a"),a("4de4"),a("c740"),a("4160"),a("c975"),a("b0c0"),a("159b"),a("b84f")),o=a("8e44"),s=a("c1df"),c=a.n(s),d=[{title:"服务器IP",dataIndex:"name"},{title:"端口",dataIndex:"port"},{title:"系统类型",dataIndex:"system_type"},{title:"所属应用",dataIndex:"app_name"},{title:"环境",dataIndex:"env_name",scopedSlots:{customRender:"env_name"}},{title:"更新时间",dataIndex:"update_date",sorter:!0,customRender:function(e){return c()(e).format("YYYY-MM-DD hh:mm")}},{title:"操作",scopedSlots:{customRender:"action"}}],u={name:"serverList",components:{BfTable:i["a"]},data:function(){return{total:0,advanced:!0,columns:d,dataSource:[],selectedRows:[],visible:!1,options:[],envOptions:[],isEdit:!1,params:{name:"",currentPage:1,pageSize:20,begin_time:"",end_time:"",sorter:""}}},beforeCreate:function(){this.form=this.$form.createForm(this,{name:"serverList"}),this.formDialog=this.$form.createForm(this,{name:"formDialog"})},created:function(){this.fetchData(),this.fetchComponentList(),this.fetchEnv()},methods:{toggleAdvanced:function(){this.advanced=!this.advanced},remove:function(){var e=this;this.dataSource=this.dataSource.filter((function(t){return-1===e.selectedRows.findIndex((function(e){return e.key===t.key}))})),this.selectedRows=[]},submitHandler:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,a){if(!e){var r=a["timePicker"];t.params.name=a["IP"],t.params.begin_time=r?r[0].format("YYYY-MM-DD"):"",t.params.end_time=r?r[1].format("YYYY-MM-DD"):"",t.fetchData()}}))},fetchData:function(){var e=this;o["a"].ServerList(this.params).then((function(t){var a=t.data;200==t.status&&0==a.code?(e.total=a.data.count,e.dataSource=a.data.results):e.dataSource=[]}))},fetchEnv:function(){var e=this;o["a"].EnvList({}).then((function(t){var a=t.data;200==t.status&&0==a.code?a.data.results.forEach((function(t){e.envOptions.push({label:t.name,value:t.id})})):(e.$message,error("无法获取环境列表~"))}))},onShowEdit:function(e){var t=this;this.visible=!0,this.isEdit=!0,this.$nextTick((function(){t.formDialog.setFieldsValue({id:e.id,ip:e.ip,port:e.port,system:e.system_type,appId:e.app,envId:e.env,description:e.description})}))},onUpdateServer:function(){var e=this;this.formDialog.validateFields((function(t,a){if(!t){var r=a["id"],n=a["ip"],i=a["port"],s=a["appId"],c=a["envId"],d=a["system"],u=a["description"]||"",l={id:r,ip:n,port:i,app_id:s,env_id:c,system_type:d,description:u};o["a"].UpdateServer(l).then((function(t){var a=t.data;200==t.status?(e.$message.success("服务器更新成功~"),e.onReset(),e.fetchData()):e.$message.error("服务器更新失败:"+a.message)}))}}))},onDelete:function(e){var t=this,a=e.id;if(void 0==a)return this.$message.error("操作参数非法！"),!1;o["a"].DeleteServer({id:a}).then((function(e){var a=e.data;200==e.status&&0==a.code?(t.$message.success("删除成功~"),t.fetchData()):t.$message.error("操作错误~:"+a.message)}))},createDialog:function(){this.visible=!0},onReset:function(){this.visible=!1,this.isEdit=!1,this.formDialog.resetFields()},onPageChange:function(e,t){this.params.currentPage=e,this.params.pageSize=t,this.fetchData()},onSizeChange:function(e,t){this.params.currentPage=1,this.params.pageSize=t,this.fetchData()},onClear:function(){this.$message.info("您清空了勾选的所有行")},onStatusTitleClick:function(){this.$message.info("你点击了状态栏表头")},onChange:function(e,t,a){console.log("Various parameters",e,t,a);var r=e.current,n=e.pageSize,i=(a.order,a.field);this.params.currentPage=r,this.params.pageSize=n,this.params.sorter=i||"",this.fetchData()},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},fetchComponentList:function(){var e=this;o["a"].AppList({}).then((function(t){var a=t.data;200==t.status&&0==a.code?a.data.results.forEach((function(t){e.options.push({label:t.name,value:t.id})})):e.$message.error("无法获取应用列表~")}))},onCreateServer:function(){var e=this;this.formDialog.validateFields((function(t,a){if(!t){var r=a["ip"],n=a["port"],i=a["appId"],s=a["envId"],c=a["system"],d=a["description"]||"",u={ip:r,port:n,app_id:i,env_id:s,system_type:c,description:d};o["a"].CreateServer(u).then((function(t){var a=t.data;200==t.status&&0==a.code?(e.$message.success("服务器新增成功~"),e.visible=!1,e.fetchData()):e.$message.error("服务器新增失败:"+a.message)}))}}))}}},l=u,p=(a("2e64"),a("2877")),f=Object(p["a"])(l,r,n,!1,null,"35db16ee",null);t["default"]=f.exports},"984f":function(e,t,a){},b84f:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"standard-table"},[a("div",{staticClass:"alert"},[e.selectedRows?a("a-alert",{attrs:{type:"info","show-icon":!0}},[a("div",{staticClass:"message",attrs:{slot:"message"},slot:"message"},[e._v(" 已选择 "),a("a",[e._v(e._s(e.selectedRows.length))]),e._v(" 项 "),a("a",{staticClass:"clear",on:{click:e.onClear}},[e._v("清空")]),e._l(e.needTotalList,(function(t,r){return[t.needTotal?a("div",{key:r},[e._v(" "+e._s(t.title)+"总计 "),a("a",[e._v(e._s(t.customRender?t.customRender(t.total):t.total))])]):e._e()]}))],2)]):e._e()],1),a("a-table",{attrs:{bordered:e.bordered,loading:e.loading,columns:e.columns,dataSource:e.dataSource,rowKey:e.rowKey,pagination:e.pagination,expandedRowKeys:e.expandedRowKeys,expandedRowRender:e.expandedRowRender,rowSelection:e.selectedRows?{selectedRowKeys:e.selectedRowKeys,onChange:e.updateSelect}:void 0},on:{change:e.onChange},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots).filter((function(e){return"expandedRowRender"!==e})),(function(t){return{key:t,fn:function(a,r,n){return[e._t(t,null,null,{text:a,record:r,index:n})]}}})),{key:e.$scopedSlots.expandedRowRender?"expandedRowRender":"",fn:function(t,a,r,n){return[e._t(e.$scopedSlots.expandedRowRender?"expandedRowRender":"",null,null,{record:t,index:a,indent:r,expanded:n})]}}],null,!0)},[e._l(Object.keys(e.$slots),(function(t){return a("template",{slot:t},[e._t(t)],2)}))],2)],1)},n=[],i=(a("4de4"),a("d81d"),a("13d5"),a("5530")),o={name:"bfTable",props:{bordered:Boolean,loading:[Boolean,Object],columns:Array,dataSource:Array,rowKey:{type:[String,Function],default:"key"},pagination:{type:[Object,Boolean],default:!0},selectedRows:Array,expandedRowKeys:Array,expandedRowRender:Function},data:function(){return{needTotalList:[]}},methods:{updateSelect:function(e,t){this.$emit("update:selectedRows",t),this.$emit("selectedRowChange",e,t)},initTotalList:function(e){var t=e.filter((function(e){return e.needTotal})).map((function(e){return Object(i["a"])(Object(i["a"])({},e),{},{total:0})}));return t},onClear:function(){this.updateSelect([],[]),this.$emit("clear")},onChange:function(e,t,a,r){var n=r.currentDataSource;this.$emit("change",e,t,a,{currentDataSource:n})}},created:function(){this.needTotalList=this.initTotalList(this.columns)},watch:{selectedRows:function(e){this.needTotalList=this.needTotalList.map((function(t){return Object(i["a"])(Object(i["a"])({},t),{},{total:e.reduce((function(e,a){return e+a[t.dataIndex]}),0)})}))}},computed:{selectedRowKeys:function(){var e=this;return this.selectedRows.map((function(t){return"function"===typeof e.rowKey?e.rowKey(t):t[e.rowKey]}))}}},s=o,c=(a("dc82"),a("2877")),d=Object(c["a"])(s,r,n,!1,null,"67e74d3c",null);t["a"]=d.exports},c740:function(e,t,a){"use strict";var r=a("23e7"),n=a("b727").findIndex,i=a("44d2"),o=a("ae40"),s="findIndex",c=!0,d=o(s);s in[]&&Array(1)[s]((function(){c=!1})),r({target:"Array",proto:!0,forced:c||!d},{findIndex:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),i(s)},d58f:function(e,t,a){var r=a("1c0b"),n=a("7b0b"),i=a("44ad"),o=a("50c4"),s=function(e){return function(t,a,s,c){r(a);var d=n(t),u=i(d),l=o(d.length),p=e?l-1:0,f=e?-1:1;if(s<2)while(1){if(p in u){c=u[p],p+=f;break}if(p+=f,e?p<0:l<=p)throw TypeError("Reduce of empty array with no initial value")}for(;e?p>=0:l>p;p+=f)p in u&&(c=a(c,u[p],p,d));return c}};e.exports={left:s(!1),right:s(!0)}},d81d:function(e,t,a){"use strict";var r=a("23e7"),n=a("b727").map,i=a("1dde"),o=a("ae40"),s=i("map"),c=o("map");r({target:"Array",proto:!0,forced:!s||!c},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},dc82:function(e,t,a){"use strict";a("2d02")}}]);