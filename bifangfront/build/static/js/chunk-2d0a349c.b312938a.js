(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a349c"],{"0215":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-card",{attrs:{"body-style":{padding:"24px 32px"},bordered:!1}},[r("a-form",{attrs:{form:e.form},on:{submit:function(t){e.isEdit?e.onUpdateApplication():e.onCreateApplication()}}},[r("a-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"ID"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id"],expression:"['id']"}],attrs:{placeholder:"自动生成"}})],1),r("a-form-item",{attrs:{label:"应用ID",labelCol:{span:7},wrapperCol:{span:10}}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["app_id",{rules:[{required:!0,message:"请输入应用ID"}]}],expression:"[\n          'app_id',\n          {\n          rules: [{ required: true, message: '请输入应用ID' }],\n          }\n      ]"}],attrs:{disabled:!!e.isEdit}})],1),r("a-form-item",{attrs:{label:"英文名称",labelCol:{span:7},wrapperCol:{span:10}}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入英文名称"}]}],expression:"[\n          'name',\n          {\n          rules: [{ required: true, message: '请输入英文名称' }],\n          }\n      ]"}],attrs:{disabled:!!e.isEdit}})],1),r("a-form-item",{attrs:{label:"中文名称",labelCol:{span:7},wrapperCol:{span:10}}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["cn_name",{rules:[{required:!0,message:"请输入中文名称"}]}],expression:"[\n          'cn_name',\n          {\n          rules: [{ required: true, message: '请输入中文名称' }],\n          }\n      ]"}]})],1),r("a-form-item",{attrs:{label:"归属项目",labelCol:{span:7},wrapperCol:{span:10}}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["project_id",{rules:[{required:!0,message:"请选择归属项目!"}]}],expression:"['project_id', { rules: [{ required: true, message: '请选择归属项目!' }] }]"}],staticStyle:{width:"100%"},attrs:{"show-search":"",placeholder:"请选择项目","option-label-prop":"children",options:e.projectOptions,"filter-option":e.filterOption}})],1),r("a-form-item",{attrs:{label:"应用描述",labelCol:{span:7},wrapperCol:{span:10}}},[r("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description"],expression:"['description']"}],attrs:{rows:"4",placeholder:"请输入应用描述"}})],1),r("a-form-item",{attrs:{label:"GIT服务器",labelCol:{span:7},wrapperCol:{span:10}}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["git_id",{rules:[{required:!0,message:"请选择归属项目!"}]}],expression:"['git_id', { rules: [{ required: true, message: '请选择归属项目!' }] }]"}],staticStyle:{width:"100%"},attrs:{"show-search":"",placeholder:"请选择Git服务器","option-filter-prop":"children","filter-option":e.filterOption}},e._l(e.gitOptions,(function(t){return r("a-select-option",{key:t.value},[e._v(" "+e._s(t.label)+" ")])})),1)],1),r("a-form-item",{attrs:{label:"GIT项目ID",labelCol:{span:7},wrapperCol:{span:10}}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["git_app_id",{rules:[{required:!0,message:"请输入git appId!"}]}],expression:"['git_app_id', { rules: [{ required: true, message: '请输入git appId!' }] }]"}],attrs:{placeholder:"请输入GIT项目ID,此ID在每个GIT服务器上是唯一的."}})],1),r("a-form-item",{attrs:{label:"Git Trigger Token",labelCol:{span:7},wrapperCol:{span:10}}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["git_trigger_token",{rules:[{required:!0,message:"请输入git token!"}]}],expression:"['git_trigger_token', { rules: [{ required: true, message: '请输入git token!' }] }]"}],attrs:{placeholder:"请输入Git Trigger Token,此token用于触发gitlab的ci/cd的pipeline"}})],1),r("a-form-item",{attrs:{label:"编译脚本",labelCol:{span:7},wrapperCol:{span:10}}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["build_script",{rules:[{required:!0,message:"请输入编译脚本路径!"}]}],expression:"['build_script', { rules: [{ required: true, message: '请输入编译脚本路径!' }] }]"}],attrs:{placeholder:"请输入编译脚本路径,是相对于gitalb项目的根目录,如script/build.sh"}})],1),r("a-form-item",{attrs:{label:"部署脚本",labelCol:{span:7},wrapperCol:{span:10}}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["deploy_script",{rules:[{required:!0,message:"请输入部署脚本路径!"}]}],expression:"['deploy_script', { rules: [{ required: true, message: '请输入部署脚本路径!' }] }]"}],attrs:{placeholder:"请输入部署脚本路径,是相对于gitalb项目的根目录,如script/deploy.sh"}})],1),r("a-form-item",{attrs:{label:"应用压缩包",labelCol:{span:7},wrapperCol:{span:10}}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["zip_package_name",{rules:[{required:!0,message:"请输入应用压缩包路径!"}]}],expression:"['zip_package_name', { rules: [{ required: true, message: '请输入应用压缩包路径!' }] }]"}],attrs:{placeholder:"请输入应用压缩包路径,目前是tar.gz格式压缩包,如go-demo.tar.gz"}})],1),r("a-form-item",{attrs:{label:"服务端口",labelCol:{span:7},wrapperCol:{span:10}}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["service_port",{rules:[{required:!0,message:"请输入服务端口!"}]}],expression:"['service_port', { rules: [{ required: true, message: '请输入服务端口!' }] }]"}],attrs:{placeholder:"请输入服务端口"}})],1),r("a-form-item",{staticStyle:{"margin-top":"24px"},attrs:{wrapperCol:{span:10,offset:7}}},[r("a-button",{attrs:{type:"primary","html-type":"submit"}},[e._v(e._s(e.btnDesc))])],1)],1)],1)},s=[],i=(r("7db0"),r("4160"),r("c975"),r("b0c0"),r("d3b7"),r("25f0"),r("159b"),r("5530"));r("a4d3"),r("e01a"),r("d28b"),r("3ca3"),r("ddb0");function o(e){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var n=r("8e44"),l={name:"appDetail",data:function(){return{isEdit:!1,type:"build",value:1,fetching:!1,projectOptions:[],projectList:[],gitOptions:[],gitList:[],btnDesc:"创建"}},beforeCreate:function(){this.form=this.$form.createForm(this,{name:"applicaitonDetail"})},created:function(){this.fetchProjectList(),this.fetchGitList(),this.$route.query.id&&(this.isEdit=!0,this.btnDesc="更新")},mounted:function(){var e=this;console.log(o(this.$route.query["project"])),this.isEdit&&this.$nextTick((function(){e.form.setFieldsValue(Object(i["a"])(Object(i["a"])({},e.$route.query),{},{project_id:e.$route.query["project"],git_id:e.$route.query["git"]}))}))},methods:{fetchProjectList:function(){var e=this;n["a"].ProjectList({}).then((function(t){var r=t.data;200==t.status&&0==r.code?(e.projectList=r.data.results,r.data.results.forEach((function(t){e.projectOptions.push({label:t.cn_name,key:t.id.toString()})}))):(e.$message,error("无法获取应用列表~"))}))},fetchGitList:function(){var e=this;n["a"].GitList({}).then((function(t){var r=t.data;200==t.status&&0==r.code?(e.gitList=r.data.results,r.data.results.forEach((function(t){e.gitOptions.push({label:t.name,value:t.id.toString()})}))):(e.$message,error("无法获取应用列表~"))}))},onCreateApplication:function(){var e=this,t=this;this.form.validateFields((function(r,a){if(!r){var s=t.projectList.find((function(e){return e.id==a["project_id"]})),o=Object(i["a"])(Object(i["a"])({},a),{},{project_name:s.name});n["a"].CreateApplication(o).then((function(t){var r=t.data;200==t.status&&0==r.code?(e.$message.success("应用创建成功~"),e.$router.push("app")):e.$message.error("应用创建失败~:"+r.message)}))}}))},onUpdateApplication:function(){var e=this,t=this;this.form.validateFields((function(r,a){if(!r){var s=t.projectList.find((function(e){return e.id==a["project_id"]})),o=Object(i["a"])(Object(i["a"])({},a),{},{project_name:s.name});n["a"].UpdateApplication(o).then((function(t){var r=t.data;200==t.status?(e.$message.success("应用更新成功~"),e.$router.push("/application/app")):e.$message.error("应用更新失败:"+r.message)}))}}))},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}}},p=l,c=r("2877"),d=Object(c["a"])(p,a,s,!1,null,"013e94d1",null);t["default"]=d.exports}}]);