(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c4a73"],{"3c6c":function(e,r,a){"use strict";a.r(r);var t=function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("a-card",{attrs:{"body-style":{padding:"24px 32px"},bordered:!1}},[a("a-form",{attrs:{form:e.form},on:{submit:e.submitHandler}},[a("a-form-item",{attrs:{label:"发布单号",labelCol:{span:7},wrapperCol:{span:10}}},[a("a-input",{attrs:{disabled:"",value:"自动生成",placeholder:"自动生成"}})],1),a("a-form-item",{attrs:{label:"项目选择",labelCol:{span:7},wrapperCol:{span:10}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["projectId",{rules:[{required:!0,message:"请选择项目!"}]}],expression:"['projectId', { rules: [{ required: true, message: '请选择项目!' }] }]"}],attrs:{"show-search":"",placeholder:"请选择项目","option-filter-prop":"children","filter-option":e.filterOption},on:{focus:e.handleFocus,blur:e.handleBlur,change:e.handleChange}},e._l(e.projectOption,(function(r){return a("a-select-option",{key:r},[e._v(" "+e._s(r)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"组件选择",labelCol:{span:7},wrapperCol:{span:10}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["appId",{rules:[{required:!0,message:"请选择发布的组件!"}]}],expression:"['appId', { rules: [{ required: true, message: '请选择发布的组件!' }] }]"}],attrs:{"show-search":"",placeholder:"请选择组件","option-filter-prop":"children","filter-option":e.filterOption},on:{focus:e.handleFocus,blur:e.handleBlur}},e._l(e.options,(function(r){return a("a-select-option",{key:r.value},[e._v(" "+e._s(r.label)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"发布分支",labelCol:{span:7},wrapperCol:{span:10}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["branch",{rules:[{required:!0,message:"请输入组件分支!"}]}],expression:"['branch', { rules: [{ required: true, message: '请输入组件分支!' }] }]"}],attrs:{placeholder:"请输入发布单分支"}})],1),a("a-form-item",{attrs:{label:"发布描述",labelCol:{span:7},wrapperCol:{span:10}}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!1,message:"请输入组件分支!"}]}],expression:"['description', { rules: [{ required: false, message: '请输入组件分支!' }] }]"}],attrs:{rows:"4",placeholder:"请输入发布单描述"}})],1),a("a-form-item",{staticStyle:{"margin-top":"24px"},attrs:{wrapperCol:{span:10,offset:7}}},[a("a-button",{attrs:{type:"primary","html-type":"submit"}},[e._v("创建")])],1)],1)],1)},o=[],s=(a("a4d3"),a("e01a"),a("4160"),a("c975"),a("b0c0"),a("b64b"),a("159b"),a("8e44")),n={name:"createRelease",data:function(){return{value:1,fetching:!1,projectOption:[],options:[],projects:{}}},beforeCreate:function(){this.form=this.$form.createForm(this,{name:"createRelease"})},created:function(){this.fetch()},computed:{desc:function(){}},methods:{fetch:function(){var e=this;s["a"].AppList({}).then((function(r){var a=r.data;200==r.status&&0==a.code?(a.data.results.forEach((function(r){e.projects[r.project_name]?e.projects[r.project_name].push({label:r.name,value:r.id}):e.projects[r.project_name]=[{label:r.name,value:r.id}]})),e.projectOption=Object.keys(e.projects)):(e.$message,error("无法获取应用列表~"))}))},handleChange:function(e){this.form.setFieldsValue({appId:""}),this.options=this.projects[e]},handleBlur:function(){console.log("blur")},handleFocus:function(){console.log("focus")},submitHandler:function(e){var r=this;e.preventDefault(),this.form.validateFields((function(e,a){if(!e){var t={name:"",app_id:a["appId"],git_branch:a["branch"],description:a["description"]};s["a"].CreateRelease(t).then((function(e){var a=e.data;200==e.status&&0==a.code?(r.$message.success("发布单创建成功~"),r.$router.push("releaseList")):200==e.status&&2e3==a.code?r.$message.error("你没有创建此应用发布单的权限！"):r.$message.error("无法获取应用列表~")}))}}))},filterOption:function(e,r){return r.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}}},l=n,i=a("2877"),c=Object(i["a"])(l,t,o,!1,null,"8bd0f786",null);r["default"]=c.exports}}]);